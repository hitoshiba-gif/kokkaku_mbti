<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="color-scheme" content="light dark">
<title>éª¨æ ¼MBTI Webè¨ºæ–­ v3ï¼ˆFinal + Brand/Styleï¼‰</title>
<style>
:root{--bg:#0f1115;--card:#161922;--ink:#e7e9ee;--muted:#aab0c0;--accent:#7c9cff;--soft:#24293a;--ok:#38d39f;--warn:#ffce5c}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;line-height:1.6;color:var(--ink);background:linear-gradient(180deg,#0e1017,#0f131d 35%,#0b0e15)}
.wrap{max-width:980px;margin:0 auto;padding:32px 20px}
header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
header .badge{padding:4px 10px;border-radius:999px;background:var(--soft);font-size:12px;color:var(--muted)}
h1{font-size:24px;margin:0}
.card{background:var(--card);border:1px solid #212638;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.25);padding:20px}
.controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
button{appearance:none;border:none;border-radius:10px;padding:12px 16px;background:var(--accent);color:#0b0e15;font-weight:700;cursor:pointer}
button.secondary{background:var(--soft);color:var(--ink)}
.muted{color:var(--muted)}
.grid{display:grid;gap:14px}
.q{padding:14px;border:1px solid #262b3a;border-radius:12px;background:#121625}
.q h4{margin:0 0 8px 0;font-size:15px}
.scale{display:flex;gap:8px;align-items:center}
.scale label{font-size:12px;color:var(--muted)}
.scale input{accent-color:var(--accent);width:100%}
.footer{display:flex;justify-content:space-between;align-items:center;margin-top:16px}
.progress{height:8px;background:#0d1220;border:1px solid #262b3a;border-radius:999px;overflow:hidden}
.bar{height:100%;background:linear-gradient(90deg,var(--accent),#8ff0d1);width:0}
.pill{padding:4px 8px;background:#111523;border:1px solid #262b3a;border-radius:999px;color:var(--muted);font-size:12px}
.result{display:grid;gap:10px}
.result h2{margin:0}
.tags{display:flex;gap:8px;flex-wrap:wrap}
.tag{padding:6px 10px;border:1px solid #2a2f40;border-radius:999px;background:#121625;color:#cfd6eb;font-size:12px}
.cols{display:grid;grid-template-columns:1fr;gap:16px}
@media(min-width:860px){.cols{grid-template-columns:1.2fr .8fr}}
table{width:100%;border-collapse:collapse}
th,td{border-bottom:1px solid #23283a;padding:8px 6px;text-align:left}
.ok{color:var(--ok)}.warn{color:var(--warn)}
.hero{width:100%;aspect-ratio:16/10;object-fit:cover;border-radius:12px;border:1px solid #2a2f40;background:#0f1220;box-shadow:0 10px 30px rgba(0,0,0,.25)}
.concept{font-size:14px;color:var(--muted);line-height:1.8}
.em{font-size:20px}
.chips{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
.chip{padding:6px 10px;border:1px solid #2a2f40;border-radius:999px;background:#111523;color:#cfd6eb;font-size:12px}
.guide h3{margin:14px 0 8px}
.guide h4{margin:10px 0 6px}
.guide ul{margin:0 0 8px 18px}
.small{font-size:12px;color:var(--muted)}

  /* æ—¢å­˜<style>å†…ã®ã©ã“ã§ã‚‚OK */
  .traits{display:grid;gap:14px;margin-top:12px}
  .trait{background:#121625;border:1px solid #262b3a;border-radius:12px;padding:12px}
  .trait .row{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
  .trait .title{font-weight:700}
  .trait .percent{font-weight:700}
  .meter{position:relative;height:10px;background:#0d1220;border:1px solid #262b3a;border-radius:999px;overflow:hidden}
  .meter .fill{position:absolute;left:0;top:0;height:100%;background:linear-gradient(90deg,var(--accent),#8ff0d1)}
  .meter .thumb{position:absolute;top:50%;transform:translate(-50%,-50%);width:18px;height:18px;border-radius:50%;
    background:#e7e9ee;border:2px solid #111523;box-shadow:0 2px 6px rgba(0,0,0,.4)}
  .trait .ends{display:flex;justify-content:space-between;font-size:12px;color:var(--muted);margin-top:6px}
/* ===== Mobile first tweaks ===== */
:root{
  --space:16px;
}

/* å…¨ä½“ã‚¿ã‚¤ãƒãƒ»ä½™ç™½ã‚’å°‘ã—å¤§ãã‚ã« */
body{ -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
.wrap{ padding: 20px var(--space); }
h1{ font-size: 20px; }

/* ã‚«ãƒ¼ãƒ‰/è³ªå•ã®è©°ã‚ã‚’å°‘ã—ã‚†ã‚‹ã */
.card{ padding:16px; border-radius:14px; }
.q{ padding:12px; border-radius:12px; }
.q h4{ font-size:14px; line-height:1.5; }

/* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’ç¸¦ç©ã¿&ãƒ•ãƒ«å¹… */
.controls{ gap:10px; }
@media (max-width: 760px){
  .controls{ flex-direction:column; }
  button, .controls button{ width:100%; padding:14px 16px; font-size:16px; }
}

/* 2ã‚«ãƒ©ãƒ â†’1ã‚«ãƒ©ãƒ ï¼ˆçµæœã‚„ã‚¬ã‚¤ãƒ‰ï¼‰ */
.cols{ grid-template-columns:1fr; }
@media (min-width: 860px){
  .cols{ grid-template-columns:1.2fr .8fr; }
}

/* é€²æ—ãƒ•ãƒƒã‚¿ãƒ¼ã‚’ã‚¹ãƒãƒ›ã§â€œä¸‹éƒ¨å›ºå®šâ€ã« */
@media (max-width: 760px){
  .footer{ 
    position: sticky; bottom: 0; z-index: 20;
    background: linear-gradient(180deg, rgba(15,17,21,0), var(--card));
    padding-top: 10px; margin-top: 18px;
  }
}

/* ãƒãƒ¼UIï¼šæŒ‡ã§è§¦ã‚Œã‚„ã™ã„ã‚µã‚¤ã‚º */
.meter{ height:14px; border-radius:999px; }
.meter .thumb{ width:22px; height:22px; }

/* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼šè¦ªæŒ‡å¤§ãã‚ï¼ˆiOS/Androidï¼‰ */
input[type=range]{ height: 30px; }
input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none; appearance:none;
  width:26px; height:26px; border-radius:50%;
  background:#e7e9ee; border:2px solid #111523; box-shadow:0 2px 6px rgba(0,0,0,.4);
}
input[type=range]::-moz-range-thumb{
  width:26px; height:26px; border-radius:50%;
  background:#e7e9ee; border:2px solid #111523; box-shadow:0 2px 6px rgba(0,0,0,.4);
}

/* ç”»åƒæ¯”ç‡ã‚’ã‚¹ãƒãƒ›å¯„ã‚Šã« */
.hero{ aspect-ratio: 4 / 3; }

/* ã‚¿ã‚°/ãƒãƒƒãƒ—ã®æŠ˜è¿”ã—é–“éš”ã‚’æ”¹å–„ */
.tags,.chips{ gap:6px; }
.chip,.tag{ font-size:11px; padding:6px 8px; }

/* å®‰å…¨åŸŸï¼ˆiOSãƒãƒƒãƒå¯¾å¿œï¼‰ */
@supports(padding:max(0px)){
  body{ padding-bottom: max(0px, env(safe-area-inset-bottom)); }
}
/* --- iPhone Safariã§çœŸã£æš—ã«ãªã‚‹ãƒã‚°å¯¾ç­– --- */
html, body {
  background-color: #0f1115 !important;
  color: #e7e9ee !important;
  height: 100%;
  min-height: 100vh;
  overflow-x: hidden;
  -webkit-text-size-adjust: 100%;
}

#app, .wrap {
  background-color: #0f1115;
  min-height: 100vh;
  position: relative;
  z-index: 1;
}

.card {
  background-color: #161922;
  color: #e7e9ee;
}

/* SafariãŒæ–‡å­—ã‚’é€æ˜åŒ–ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã®ã§å¼·åˆ¶æŒ‡å®š */
h1, h2, h3, p, span, label, button {
  color: #e7e9ee !important;
}

/* èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒé€éã—ã¦è¦‹ãˆãªã„ã¨ãã®ãŸã‚ */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: linear-gradient(180deg, #0e1017, #0f131d 35%, #0b0e15);
  z-index: 0;
}
/* ===== Dashboard styling ===== */
.dash{ margin-top: 40px; }
.dash-card{
  background: var(--card);
  border: 1px solid #23283a;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
  padding: 18px;
}
.dash-head{ display:flex; justify-content:space-between; align-items:baseline; gap:10px; }
.dash-head h2{ margin: 0; font-size: 18px; }
.dash-head .muted{ margin: 0; }

.dash-frame{
  margin-top: 12px;
  border-radius: 12px;
  overflow: hidden;               /* è§’ä¸¸ã‚’åŠ¹ã‹ã›ã‚‹ */
  background: #0f1115;            /* iFrameèª­è¾¼å‰ã®è‰² */
  border: 1px solid #2a2f40;
}

/* iFrameã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã«ï¼ˆ16:9ï¼‰ */
.dash-embed{
  width: 100%;
  aspect-ratio: 16 / 9;           /* ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶OK */
  display: block;
  border: 0;
}

/* æ¨ªå¹…ã‚’åºƒã’ã™ããªã„ */
@media (min-width: 860px){
  .dash-card{ padding: 22px; }
  .dash{ max-width: 1100px; margin-left:auto; margin-right:auto; }
}





</style>
</head>
<body>
<div class="wrap">
  <header>
    <span class="badge">Final Edition</span>
    <h1>éª¨æ ¼MBTI Webè¨ºæ–­ v3</h1>
  </header>
  <div id="app" class="card"></div>
  <section id="dashboard" class="dash">
  <div class="dash-card">
    <div class="dash-head">
      <h2>ã¿ã‚“ãªã®è¨ºæ–­å‚¾å‘</h2>
      <p class="muted">æœ€æ–°é›†è¨ˆã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º</p>
    </div>

    <div class="dash-frame">
      <iframe
        class="dash-embed"
        src="https://lookerstudio.google.com/embed/reporting/6a1b780b-386d-466c-9624-2e5f9f93f90c/page/Dk1cF"
        allowfullscreen
        frameborder="0">
      </iframe>
    </div>
  </div>
</section>

</div>

<script>
  // ============ Google Sheetsé€£æºè¨­å®š ============
const GAS_URL = "https://script.google.com/macros/s/AKfycbxVWOXNr9rqQsIE5kJl5Ujk1gUJXTIhXGivuojjZbOtGwyvq4-Pp6F4u6K6o7DV9Nuj/exec"
function sendToSheets(payload){
  console.log('[GAS] sending...', payload);
  return fetch(GAS_URL, {
    method: "POST",
    // â˜… ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆã‚’ç™ºç”Ÿã•ã›ãªã„è¨±å¯ã‚¿ã‚¤ãƒ—
    headers: { "Content-Type": "text/plain" },
    body: JSON.stringify(payload),
  })
  .then(r => r.text().then(t => {
    console.log('[GAS] response:', r.status, t);
    return { status: r.status, body: t };
  }))
  .catch(e => console.error('[GAS] error:', e));
}

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åŒæ„çŠ¶æ…‹ã‚’ä¿å­˜/å–å¾—ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿æŒï¼‰
const CONSENT_KEY = 'km_consent'; // 'yes' | 'no'
function getConsent(){ return localStorage.getItem(CONSENT_KEY) ?? 'yes'; } // æ—¢å®š=åŒæ„
function setConsent(v){ localStorage.setItem(CONSENT_KEY, v ? 'yes' : 'no'); }

function makeInitialState(){
  const make = n => Array(n).fill(3); // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼åˆæœŸå€¤=3
  return {
    step: 0,
    _sentOnce: false,                 // è‡ªå‹•é€ä¿¡ãƒ•ãƒ©ã‚°ã‚‚ãƒªã‚»ãƒƒãƒˆ
    answers: {
      frame:   make(12),
      surface: make(12),
      balance: make(12),
      line:    make(12)
    }
  };
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ 4è»¸å®šç¾© â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const AXES = [
  {key:'frame', codePos:'B', codeNeg:'M', label:'æ§‹é€ è»¸ï¼ˆFrameï¼‰', posLabel:'éª¨æ ¼ä¸»å°ï¼ˆBï¼‰', negLabel:'è‚‰ä»˜ãä¸»å°ï¼ˆMï¼‰', threshold:3.5},
  {key:'surface', codePos:'W', codeNeg:'N', label:'é¢ç©è»¸ï¼ˆDensityï¼‰', posLabel:'èº«ä½“ãƒ•ãƒ¬ãƒ¼ãƒ åºƒï¼ˆLï¼‰', negLabel:'èº«ä½“ãƒ•ãƒ¬ãƒ¼ãƒ ç‹­ï¼ˆNï¼‰', threshold:3.5},
  {key:'balance', codePos:'U', codeNeg:'L', label:'é‡å¿ƒè»¸ï¼ˆBalanceï¼‰', posLabel:'ä¸Šé‡å¿ƒï¼ˆUï¼‰', negLabel:'ä¸‹é‡å¿ƒï¼ˆLï¼‰', threshold:3.5},
  {key:'line', codePos:'C', codeNeg:'S', label:'ãƒ©ã‚¤ãƒ³è»¸ï¼ˆLineï¼‰', posLabel:'ç›´ç·šï¼ˆCï¼‰', negLabel:'æ›²ç·šï¼ˆSï¼‰', threshold:3.5}
];

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ è³ªå•ï¼ˆå„12å•ãƒ»5æ®µéšï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const QUESTIONS = {
  frame:[
    {t:'é–éª¨ã‚„è‚‹éª¨ã®ãƒ©ã‚¤ãƒ³ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹',pos:true},
    {t:'æ‰‹é¦–ã‚„è¶³é¦–ã®éª¨ãŒç›®ç«‹ã¡ã€ãã®ä»–ã®éƒ¨ä½ã‚‚é–¢ç¯€ãŒç›®ç«‹ã¤',pos:true},
    {t:'è‚©ã‚„å¤ªã‚‚ã‚‚ã«éª¨ã¼ã­ã—ã•ã‚’æ„Ÿã˜ã‚‹',pos:false},
    {t:'ä½“å…¨ä½“ãŒç›´ç·šçš„ã§ã€å‡¹å‡¸ãŒå°‘ãªã„',pos:true},
    {t:'å‹•ã„ãŸã¨ãã€ç­‹è‚‰ã®å‹•ããŒã‚ã‹ã‚Šãšã‚‰ã„',pos:false},
    {t:'èº«ä½“ä»˜ããŒã€Œã‚·ãƒ£ãƒ¼ãƒ—ã€ã¨è¨€ã‚ã‚Œã‚‹',pos:true},
    {t:'é¡”ã«è„‚è‚ªãŒã¤ãã«ãã„',pos:false},
    {t:'å†™çœŸã§è¦‹ã‚‹ã¨éª¨ã®ä½ç½®ãŒã‚ã‹ã‚‹',pos:true},
    {t:'åšæ‰‹ã®æœã§ã‚‚éª¨ã®å½¢ãŒå‡ºã‚„ã™ã„',pos:true},
    {t:'é‹å‹•ã‚’ã—ã¦ã‚‚ç­‹è‚‰ãŒã¤ããšã‚‰ã„',pos:false},
    {t:'åº§ã‚‹ã¨éª¨ç›¤ã‚„é–¢ç¯€ãŒã”ã¤ã”ã¤æ„Ÿã˜ã‚‰ã‚Œã‚‹',pos:true},
    {t:'è‡ªåˆ†ã®ä½“å‹ã¯ã€Œéª¨ã®å½¢ã€ã«ã‚ˆã£ã¦æ±ºã¾ã£ã¦ã„ã‚‹',pos:true}
  ],
  surface:[
    {t:'å‘¨å›²ã‹ã‚‰å®Ÿéš›ã®èº«é•·ã‚ˆã‚Šã‚‚å¤§ããè¦‹ãˆã‚‹ã¨è¨€ã‚ã‚Œã‚‹',pos:true},
    {t:'è‚©å¹…ã®å¤§ãã•ãŒé¡”ã®æ¨ªå¹…ä¸‰ã¤åˆ†ã®å¤§ãã•ã‚ˆã‚Šã‚‚å¤§ãã„',pos:true},
    {t:'åšæ‰‹ã‚ˆã‚Šè–„æ‰‹ãƒ»è»½ã„ç´ æãŒã—ã£ãã‚Šãã‚‹',pos:true},
    {t:'é™æ­¢ã™ã‚‹ã¨å­˜åœ¨æ„ŸãŒå¼·ãã€å®‰å®šã—ã¦è¦‹ãˆã‚‹',pos:false},
    {t:'è…•ã®é•·ã•ãŒè†ã¨ãŠå°»ã®ä¸­é–“ãã‚‰ã„ã¾ã§ã‚ã‚‹',pos:true},
    {t:'æ‰‹ãŒå¤§ãã„ã¨ã‚ˆãè¨€ã‚ã‚Œã‚‹',pos:true},
    {t:'ä½“ã®ãƒ¡ãƒªãƒãƒªãŒå°‘ãªã„',pos:true},
    {t:'å†™çœŸã§ä»–äººã¨ä¸¦ã¶ã¨èº«ä½“ãŒå¤§ããè¦‹ãˆã‚‹',pos:true},
    {t:'é¦–å…ƒãŒã‚†ã£ãŸã‚Šã—ãŸæœãŒã‚ˆãä¼¼åˆã†',pos:false},
    {t:'åšã¿ãŒãªãæ¨ªã«åºƒãŒã‚‹ã‚ˆã†ãªä½“å‹ã‚’ã—ã¦ã„ã‚‹',pos:false},
    {t:'ãƒ“ãƒƒã‚°ã‚·ãƒ«ã‚¨ãƒƒãƒˆã®æœãŒä¼¼åˆã†',pos:false},
    {t:'é£Ÿã¹ã¦ã‚‚ç­‹è‚‰ã‚„è„‚è‚ªãŒä»˜ãã¥ã‚‰ã„',pos:false}
  ],
  balance:[
    {t:'é¡ã‚’è¦‹ã‚‹ã¨ä¸ŠåŠèº«ãŒç›®ç«‹ã¤ã‚ˆã†ã«æ„Ÿã˜ã‚‹',pos:true},
    {t:'è…°ãƒ»ãƒ’ãƒƒãƒ—ãŒç›®ç«‹ã¤',pos:false},
    {t:'è„šãŒé•·ãè¦‹ãˆã‚‹',pos:true},
    {t:'ã‚¦ã‚¨ã‚¹ãƒˆãƒ©ã‚¤ãƒ³ãŒé«˜ãè¦‹ãˆã‚‹',pos:false},
    {t:'åº§ã‚‹ã¨ä¸ŠåŠèº«ãŒè©°ã¾ã£ã¦è¦‹ãˆã‚‹',pos:true},
    {t:'ç«‹ã¤ã¨èƒ¸ã‚„è‚©ã®ä½ç½®ãŒé«˜ãè¦‹ãˆã‚‹',pos:true},
    {t:'ãƒœãƒ‡ã‚£ãƒ©ã‚¤ãƒ³ã®å‡ºã‚‹æœãŒä¼¼åˆã†',pos:false},
    {t:'ãƒˆãƒƒãƒ—ã‚¹ã«ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’å‡ºã™ã¨ä¼¼åˆã†',pos:true},
    {t:'ãƒ¯ã‚¤ãƒ‰ãƒ‘ãƒ³ãƒ„ã‚ˆã‚Šã‚‚ã‚¹ã‚­ãƒ‹ãƒ¼ãƒ‘ãƒ³ãƒ„ãŒä¼¼åˆã†',pos:false},
    {t:'ä¸ŠåŠèº«ã«ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã‚„æŸ„ã‚’æŒã£ã¦ãã‚‹ã¨ã—ã£ãã‚Šãã‚‹',pos:true},
    {t:'é¦–ã®é•·ã•ãŒçŸ­ã‚',pos:false},
    {t:'ç€ä¸ˆã®çŸ­ã„ãƒˆãƒƒãƒ—ã‚¹ãŒä¼¼åˆã†',pos:true}
  ],
  line:[
    {t:'æ‰‹è¶³ã‚„ä½“ã®è¼ªéƒ­ãŒã¾ã£ã™ãã«è¦‹ãˆã‚‹',pos:true},
    {t:'è‚©ã‚„è…°ã«ä¸¸ã¿ãŒãªã„',pos:false},
    {t:'ã€Œã‚·ãƒ£ãƒ¼ãƒ—ã€ã¨è¨€ã‚ã‚Œã‚‹',pos:true},
    {t:'é¦–å…ƒãŒç©ºã„ã¦ã„ã‚‹æœã¯è²§ç›¸ã«è¦‹ãˆã‚‹ã¨è¨€ã‚ã‚Œã‚‹',pos:false},
    {t:'ç›´ç·šçš„ãªæœãŒä¼¼åˆã†',pos:true},
    {t:'ã‚¹ãƒ¼ãƒ„ã‚„ã‚·ãƒ£ãƒ„ãŒã‚ˆãä¼¼åˆã†',pos:false},
    {t:'å‹•ä½œãŒã‚­ãƒ“ã‚­ãƒ“ã—ã¦ã„ã‚‹å°è±¡ãŒã‚ã‚‹',pos:true},
    {t:'ã‚ªãƒ¼ãƒãƒ¼ã‚µã‚¤ã‚ºã®æœã‚’åˆ‡ã‚‹ã¨ç€ç—©ã›ã™ã‚‹',pos:false},
    {t:'æ¨ªé¡”ã‚„æ¨ªå§¿ãŒç›´ç·šçš„ã«è¦‹ãˆã‚‹',pos:true},
    {t:'é¡”ã®éª¨ãŒç›®ç«‹ã¤',pos:false},
    {t:'ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãªé«ªå‹ãŒã‚ˆãä¼¼åˆã†',pos:true},
    {t:'å…¨ä½“ã®å°è±¡ãŒã€Œã™ã£ãã‚Šã€ã—ã¦ã„ã‚‹',pos:true}
  ]
};

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Final TYPE å®šç¾©ï¼ˆ16ã‚¿ã‚¤ãƒ—ï¼šå‹•ç‰©ãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ»ãƒãƒ¼ãƒˆï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
/* ç”»åƒã¯ä»»æ„ï¼ˆimages/CODE.jpgï¼‰ã€‚brandHints/styleNotes ã¯çµæœç”»é¢ã«è¡¨ç¤º */
const TYPE_META = {
  /* WAVEï¼ˆæŸ”ãƒ»è»½ãƒ»ä¸‹é‡å¿ƒï¼‰ */
  BNLS:{name:'Romantic Wave', base:'WAVE', emoji:'ğŸ¨', animal:'ã‚³ã‚¢ãƒ©',
    image:'images/BNLS.jpg',
    concept:'ç”˜ãã‚„ã‚ã‚‰ã‹ã€åŒ…å®¹æ„Ÿã®ã‚ã‚‹ãƒ­ãƒãƒ³ã€‚',
    brandHints:['SNIDEL','CELFORD','TOCCA','Lily Brown','FRAY I.D','IÃ‰NA','Noela'],
    styleNotes:['ã‚½ãƒ•ãƒˆãªæ›²ç·šã‚·ãƒ«ã‚¨ãƒƒãƒˆ','ãƒ‰ãƒ¬ãƒ¼ãƒ—/ã‚®ãƒ£ã‚¶ãƒ¼ã®åˆ†é‡ã¯ã‚„ã‚„æ§ãˆã‚','è½ã¡æ„Ÿã‚ã‚‹ãƒŸãƒ‡ã‚£ä¸ˆ','ä¸­ï½æ·¡è‰²ã®ãƒ¯ãƒ³ãƒˆãƒ¼ãƒ³','ã‚¢ã‚¯ã‚»ã¯ä¸¸ãƒ¢ãƒãƒ¼ãƒ•'],
    celebrities: {
    jp: ['åŒ—å·æ™¯å­','æœ‰æ‘æ¶ç´”','çŸ³ç”°ã‚†ã‚Šå­'],
    kr: ['TWICE ãƒŠãƒ¨ãƒ³','LE SSERAFIM ã‚µã‚¯ãƒ©'],
    global: ['Lily Collins','Emma Watson']
  }
},
  MNLC:{name:'Urban Elegance (Wave)', base:'WAVE', emoji:'ğŸº', animal:'ã‚ªã‚ªã‚«ãƒŸ',
    image:'images/MNLC.jpg',
    concept:'é™ã‹ã§èŠ¯ã®ã‚ã‚‹å„ªã—ã•ã€ç©ã‚„ã‹ã«çŸ¥çš„ãªæ´—ç·´ã€‚',
    brandHints:['IÃ‰NA','Mila Owen','Plage','N.O.R.C','URBAN RESEARCH','TOMORROWLAND'],
    styleNotes:['Iãƒ©ã‚¤ãƒ³ã‚’ãƒ™ãƒ¼ã‚¹ã«æŸ”ã‚‰ã‹ç´ æ','ãƒ­ãƒ³ã‚°Ã—ãƒ­ãƒ³ã‚°ã‚ˆã‚Šä¸Šã«ä¸€ç‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ ','ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã‚«ãƒ©ãƒ¼ã§éƒ½ä¼šçš„ã«','ã‚·ãƒ£ãƒ¼ãƒ—éããªã„ãƒ†ãƒ¼ãƒ©ãƒ¼ãƒ‰'],
    celebrities: {
    jp: ['é»’æœ¨è¯','å®®å´ã‚ãŠã„','å‰é«˜ç”±é‡Œå­'],
    kr: ['ITZY ãƒªã‚¢'],
    global: ['Keira Knightley','Natalie Portman']
  }
},
  MWLC:{name:'Light Wave', base:'WAVE', emoji:'ğŸ¦‹', animal:'ãƒã‚¿ãƒ•ãƒ©ã‚¤',
    image:'images/MWLC.jpg',
    concept:'é¢¨ã«èˆã†é€æ˜æ„Ÿã€ã¾ã£ã™ãã§è»½ã‚„ã‹ãªå‡è¡¡ã€‚',
    brandHints:['N.O.R.C','IÃ‰NA','UNIQLO','BEAUTY&YOUTH','TOMORROWLAND','LE PHIL'],
    styleNotes:['ç›´ç·šÃ—è–„æ‰‹ã§è»½ã‚„ã‹ã«','ãƒã‚¤ã‚¦ã‚¨ã‚¹ãƒˆã§è„šé•·è¦‹ã›','ä½™ç™½ã‚’ä½œã‚‹ã‚·ãƒ§ãƒ¼ãƒˆä¸ˆãƒˆãƒƒãƒ—ã‚¹','ç¹Šç´°ã‚¢ã‚¯ã‚»ã§è»½ã•ã‚’å¼·èª¿'],
    celebrities: {
    jp: ['æµœè¾ºç¾æ³¢','å €åŒ—çœŸå¸Œ'],
    kr: ['NewJeans ãƒ˜ã‚¤ãƒ³'],
    global: ['Selena Gomez','Lily Collins']
  }
},
  MWLS:{name:'Natural Girly', base:'WAVE', emoji:'ğŸ¹', animal:'ãƒãƒ ã‚¹ã‚¿ãƒ¼',
    image:'images/MWLS.jpg',
    concept:'ä¸¸ã¿ã¨æ¸©ã‹ã¿ã€ãµã‚“ã‚ã‚Šã¨ã—ãŸå¯æ†ã•ã€‚',
    brandHints:['SNIDEL','earth music&ecology','Kastane','LOWRYS FARM','tocco closet'],
    styleNotes:['Aãƒ©ã‚¤ãƒ³/ãƒ•ãƒ¬ã‚¢ã§ä¸‹é‡å¿ƒã‚’æ´»ã‹ã™','æŸ”ã‚‰ã‹ãƒ‹ãƒƒãƒˆã¨ã‚¹ã‚«ãƒ¼ãƒˆã®çµ„åˆã›','ä¸¸è¥Ÿ/ã‚¹ã‚«ãƒ¼ãƒ•ã‚¿ã‚¤ã§å¯æ†ã«','å°ã¶ã‚Šãƒãƒƒã‚°ã§é‡ã•ã‚’å‡ºã•ãªã„'],
    celebrities: {
    jp: ['ä¸Šæˆ¸å½©','æ¡œäº•æ—¥å¥ˆå­'],
    kr: ['aespa ã‚¦ã‚£ãƒ³ã‚¿ãƒ¼','Red Velvet ã‚¢ã‚¤ãƒªãƒ¼ãƒ³'],
    global: ['Ariana Grande','Selena Gomez']
  }
},
  MNLS:{name:'Classic Feminine', base:'WAVE', emoji:'ğŸ•Š', animal:'ç™½é³©',
    image:'images/MNLS.jpg',
    concept:'æŸ”ã‚‰ã‹ãä¸Šå“ã€ç©ã‚„ã‹ã«é¦™ã‚‹ã‚¨ãƒ¬ã‚¬ãƒ³ã‚¹ã€‚',
    brandHints:['TOCCA','EPOCA','FOXEY','ANAYI','Apuweiser-riche'],
    styleNotes:['æ›²ç·šçš„ãªãƒãƒƒã‚¯/ãƒãƒ¼ãƒˆãƒãƒƒã‚¯','ãƒŸãƒ‡ã‚£ï½ãƒ­ãƒ³ã‚°ã®ãƒ•ãƒ¬ã‚¢','ã‚µãƒ†ãƒ³/ã‚¸ãƒ§ãƒ¼ã‚¼ãƒƒãƒˆã®è‰¶','ä¸Šå“ãªçœŸç ã‚¢ã‚¯ã‚»'],
    celebrities: {
    jp: ['æ–°å£çµè¡£','ç™½çŸ³éº»è¡£'],
    kr: ['IVE ã‚¦ã‚©ãƒ‹ãƒ§ãƒ³','Red Velvet ã‚¢ã‚¤ãƒªãƒ¼ãƒ³'],
    global: ['Ariana Grande','Lily Collins']
  }
},
  BNLC:{name:'Earth Wave', base:'WAVE', emoji:'ğŸ»', animal:'ã‚¯ãƒ',
    image:'images/BNLC.jpg',
    concept:'ã‚ãŸãŸã‹ãåŒ…ã¿è¾¼ã‚€å®‰å®šæ„Ÿã€ç™’ã—ã®é‡å¿ƒã€‚',
    brandHints:['URBAN RESEARCH ROSSO','Plage','DOORS','JOURNAL STANDARD relume','IÃ‰NA'],
    styleNotes:['ãƒ­ãƒ³ã‚°ã‚«ãƒ¼ãƒ‡ã‚„ã‚«ãƒãƒ¼ã‚ªãƒ¼ãƒ«ã§åŒ…ã¿è¾¼ã‚€','è½ã¡æ„Ÿç´ æã§é‡ã•ã‚’åˆ†æ•£','ä¸­æ˜åº¦ã‚¢ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼','é´ã¯åšåº•ã™ããªã„å®‰å®šå‹'],
    celebrities: {
    jp: ['å®®å´ã‚ãŠã„','é»’æœ¨è¯'],
    kr: ['ITZY ãƒªã‚¢'],
    global: ['Keira Knightley','Kristen Stewart']
  }
},

  /* NATURALï¼ˆBLç³»ã®ã¿ï¼‰ */
  BWUC:{name:'Urban Natural', base:'NATURAL', emoji:'ğŸ¦„', animal:'ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ³',
    image:'images/BWUC.jpg',
    concept:'ç›´ç·šÃ—ä½™ç™½ã€å¹»æƒ³ã¨æ§‹é€ ã®èª¿å’Œã€‚',
    brandHints:['JOURNAL STANDARD','UNITED ARROWS','BEAUTY&YOUTH','AURALEE','YLEVE','TODAYFUL'],
    styleNotes:['ç›´ç·šÃ—ã‚†ã¨ã‚Šã®ãƒŸãƒ‹ãƒãƒ«','è»½ã„ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—','ä½™ç™½ã‚’æ®‹ã™ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³','ç¡¬ã™ããªã„ä¸Šè³ªç´ æ'],
    celebrities: {
    jp: ['ä¸­æ‘ã‚¢ãƒ³','æ°´åŸå¸Œå­'],
    kr: ['BLACKPINK ãƒªã‚µ','LE SSERAFIM ãƒ¦ãƒ³ã‚¸ãƒ³'],
    global: ['Cara Delevingne','Gigi Hadid']
  }
},
  BWUS:{name:'Fairy Natural', base:'NATURAL', emoji:'ğŸ¦…', animal:'ã‚¿ã‚«',
    image:'images/BWUS.jpg',
    concept:'è»½ã‚„ã‹ã§é€å¾¹ã—ãŸçŸ¥æ€§ã€ä¿¯ç°ã®ç¾å­¦ã€‚',
    brandHints:['ENFÃ–LD','Deuxieme Classe','TOMORROWLAND','athoos','COS'],
    styleNotes:['ä¸ŠåŠèº«ã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«','ç›´ç·šå¤šã‚ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰','æ·¡è‰²Ã—ç„¡æ©Ÿè³ªã‚¢ã‚¯ã‚»','ã‚¯ãƒªãƒ¼ãƒ³ãªã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼/ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ¼'],
    celebrities: {
    jp: ['ç¶¾ç€¬ã¯ã‚‹ã‹','æˆ¸ç”°æµæ¢¨é¦™'],
    kr: ['NewJeans ãƒ˜ãƒªãƒ³'],
    global: ['Zendaya','Keira Knightley']
  }
},
  BWLC:{name:'Classic Natural', base:'NATURAL', emoji:'ğŸ¦Š', animal:'ã‚­ãƒ„ãƒ',
    image:'images/BWLC.jpg',
    concept:'ç«¯æ­£ã§æ©Ÿæ•ã€è‡ªç„¶ä½“ã®å“æ ¼ã€‚',
    brandHints:['IÃ‰NA','Plage','TOMORROWLAND','BEAMS','URBAN RESEARCH'],
    styleNotes:['ç«¯æ­£ãªã‚·ãƒ£ãƒ„/ãƒ†ãƒ¼ãƒ©ãƒ¼ãƒ‰','ãƒªãƒãƒ³/ã‚³ãƒƒãƒˆãƒ³ã§æ¸…æ¶¼æ„Ÿ','ã‚»ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ¬ã‚¹ã§ç›´ç·šå¼·èª¿','è‰²ã¯ãƒ™ãƒ¼ã‚¸ãƒ¥ï½ãƒã‚¤ãƒ“ãƒ¼è»¸'],
    celebrities: {
    jp: ['å‰é«˜ç”±é‡Œå­','æ'],
    kr: ['LE SSERAFIM ãƒ¦ãƒ³ã‚¸ãƒ³'],
    global: ['Cara Delevingne','Keira Knightley']
  }
},

  BWLS:{name:'Pure Natural', base:'NATURAL', emoji:'ğŸ¦Œ', animal:'ã‚·ã‚«',
    image:'images/BWLS.jpg',
    concept:'æŸ”ã‚‰ã‹ãé™ã‹ãªèª¿å’Œã€æ£®ã®ä¸­ã®å®‰ã‚‰ãã€‚',
    brandHints:['nest Robe','Vermeerist BEAMS','Plage','Journal Standard Lâ€™essage'],
    styleNotes:['ä¸‹ã«è½ã¡ã‚‹Aãƒ©ã‚¤ãƒ³','ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒ¼ã‚’é‡ã­ã‚‹','ã‚½ãƒ•ãƒˆã‚«ãƒ©ãƒ¼ã§ã‚°ãƒ©ãƒ‡','ã‚¢ã‚¯ã‚»ã¯æœ¨/é©ãªã©è‡ªç„¶ç´ æ'],
    celebrities: {
    jp: ['å®®å´ã‚ãŠã„','é»’æœ¨è¯'],
    kr: ['aespa ã‚¦ã‚£ãƒ³ã‚¿ãƒ¼','NewJeans ãƒ˜ãƒªãƒ³'],
    global: ['Keira Knightley','Kristen Stewart']
  }
},

  /* STRAIGHTï¼ˆåšãƒ»ç«‹ä½“ãƒ»ä¸Šé‡å¿ƒï¼‰ */
  BNUS:{name:'Elegant Straight', base:'STRAIGHT', emoji:'ğŸ†', animal:'ãƒ‘ãƒ³ã‚µãƒ¼',
    image:'images/BNUS.jpg',
    concept:'å‡›ã¨ã—ã¦æ§‹ç¯‰çš„ã€éƒ½ä¼šçš„ãƒ¢ãƒ¼ãƒ‰ã€‚',
    brandHints:['Theory','Max Mara','FOXEY','PLST','LE PHIL','TIBI'],
    styleNotes:['ä¸Šé‡å¿ƒã‚’æ´»ã‹ã™ã‚·ãƒ§ãƒ¼ãƒˆä¸ˆÃ—ãƒã‚¤ã‚¦ã‚¨ã‚¹ãƒˆ','ç›´ç·šãƒ†ãƒ¼ãƒ©ãƒ¼ãƒ‰','ãƒãƒªç´ æã®Iãƒ©ã‚¤ãƒ³','é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆé…è‰²'],
    celebrities: {
    jp: ['é•·æ¾¤ã¾ã•ã¿','ç”°ä¸­ã¿ãªå®Ÿ'],
    kr: ['IVE ãƒ¦ã‚¸ãƒ³'],
    global: ['Jennifer Lopez','Scarlett Johansson']
  }
},

  MWUC:{name:'Sporty Cool', base:'STRAIGHT', emoji:'ğŸ¦ˆ', animal:'ã‚µãƒ¡',
    image:'images/MWUC.jpg',
    concept:'é‹­ãã‚¹ãƒãƒ¼ãƒˆã€ç ”ãæ¾„ã¾ã•ã‚ŒãŸã‚¹ãƒ”ãƒ¼ãƒ‰æ„Ÿã€‚',
    brandHints:['NIKE Sportswear','adidas Originals','P.E NATION','COS','UNIQLO U'],
    styleNotes:['ã‚¯ãƒªãƒ¼ãƒ³ãªã‚¢ã‚¹ãƒ¬ã‚¸ãƒ£ãƒ¼','ç›´ç·šçš„ãƒˆãƒ©ãƒƒã‚¯ãƒ‘ãƒ³ãƒ„Ã—çŸ­ä¸ˆãƒˆãƒƒãƒ—ã‚¹','æ©Ÿèƒ½ç´ æÃ—ãƒ¢ãƒãƒˆãƒ¼ãƒ³','ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼ã¯åšåº•ã™ããªã„'],
    celebrities: {
    jp: ['åºƒç€¬ã™ãš','èœã€…ç·’'],
    kr: ['Red Velvet ã‚¹ãƒ«ã‚®'],
    global: ['Taylor Swift','Gal Gadot']
  }
},

  MNUC:{name:'Glamorous Cool', base:'STRAIGHT', emoji:'ğŸ…', animal:'ãƒˆãƒ©',
    image:'images/MNUC.jpg',
    concept:'ç«‹ä½“æ„Ÿã¨è‰²æ°—ã€å¼·ã„å­˜åœ¨æ„Ÿã€‚',
    brandHints:['Max Mara','ZARA Premium','THE ROW','LE CIEL BLEU','NÂ°21'],
    styleNotes:['åšã¿Ã—ç›´ç·šã§æ§‹ç¯‰','ã‚¦ã‚¨ã‚¹ãƒˆä½ç½®ã‚’é«˜ã','ãƒ€ãƒ¼ã‚¯ãƒˆãƒ¼ãƒ³ã«ä¸€ç‚¹å…‰æ²¢','ãƒ’ãƒ¼ãƒ«ã§é‡å¿ƒã‚’ä¸Šã¸'],
    celebrities: {
    jp: ['æ·±ç”°æ­å­','ä½ã€…æœ¨å¸Œ'],
    kr: ['BLACKPINK ã‚¸ã‚¹','TWICE ãƒ¢ãƒ¢'],
    global: ['Angelina Jolie','Jennifer Lopez']
  }
},

  MNUS:{name:'Romantic Mode', base:'STRAIGHT', emoji:'ğŸ¦š', animal:'ã‚¯ã‚¸ãƒ£ã‚¯',
    image:'images/MNUS.jpg',
    concept:'åŠ›ã¨å„ªé›…ã®å…±å­˜ã€è¯ã‚„ã‹ãªä½™éŸ»ã€‚',
    brandHints:['Self-Portrait','NÂ°21','SNIDELï¼ˆãƒ‰ãƒ¬ã‚¹ãƒ©ã‚¤ãƒ³ï¼‰','FOXEY','Apuweiser-riche'],
    styleNotes:['æ›²ç·šã‚’å…¥ã‚ŒãŸãƒ¢ãƒ¼ãƒ‰','åšæ‰‹ã‚µãƒ†ãƒ³/ã‚¿ãƒ•ã‚¿','ã‚¦ã‚¨ã‚¹ãƒˆãƒãƒ¼ã‚¯å¼·','ã‚¸ãƒ¥ã‚¨ãƒªãƒ¼ã¯å­˜åœ¨æ„Ÿã‚ã‚Š'],
    celebrities: {
    jp: ['çŸ³åŸã•ã¨ã¿','æ©‹æœ¬ç’°å¥ˆ'],
    kr: ['aespa ã‚«ãƒªãƒŠ'],
    global: ['Anne Hathaway','Natalie Portman']
  }
},

  MWUS:{name:'Soft Active (Straight)', base:'STRAIGHT', emoji:'ğŸ¬', animal:'ã‚¤ãƒ«ã‚«',
    image:'images/MWUS.jpg',
    concept:'ã™ã£ãã‚Šã¨ã—ãŸæµç·šã€ã—ãªã‚„ã‹ãªèºå‹•æ„Ÿã€‚',
    brandHints:['PLEATS PLEASE','ISSEY MIYAKE','UNIQLO U','Theory','Lululemonï¼ˆã‚¯ãƒªãƒ¼ãƒ³ç³»ï¼‰'],
    styleNotes:['æµç·šå‹ã®ç›´ç·šÃ—è»½ç´ æ','ãƒã‚¤ã‚¦ã‚¨ã‚¹ãƒˆã§è„šé•·','ã‚¹ãƒƒã‚­ãƒªè¥Ÿ/ã‚¯ãƒ«ãƒ¼/ãƒœãƒ¼ãƒˆ','é…è‰²ã¯å¯’è‰²ä¸­å¿ƒã«ã‚¯ãƒªã‚¢ã«'],
    celebrities: {
    jp: ['æœ¨æ‘æ–‡ä¹ƒ','åºƒç€¬ã™ãš'],
    kr: ['Red Velvet ã‚¹ãƒ«ã‚®','IVE ãƒ¦ã‚¸ãƒ³'],
    global: ['Taylor Swift','Gal Gadot']
  }
},

  BNUC:{name:'Structural Mode', base:'STRAIGHT', emoji:'ğŸ¦‰', animal:'ãƒ•ã‚¯ãƒ­ã‚¦',
    image:'images/BNUC.jpg',
    concept:'ç²¾å¯†ã§æ§‹ç¯‰çš„ã€å¤œã«å…‰ã‚‹çŸ¥æ€§ã€‚',
    brandHints:['COS','Theory','AURALEE','HYKE','Sâ€™YTE','UNIQLO +J'],
    styleNotes:['ãƒ¢ãƒãƒˆãƒ¼ãƒ³Ã—å»ºç¯‰çš„ãƒ©ã‚¤ãƒ³','ã‚·ãƒ§ãƒ¼ãƒˆä¸ˆã‚¸ãƒ£ã‚±ãƒƒãƒˆã§ä¸Šé‡å¿ƒ','ç¡¬è³ªç´ æã§ç›´ç·šã‚’å¼·èª¿','é‡‘å±ç³»ã‚¢ã‚¯ã‚»ã§çŸ¥æ€§ã‚’è£œå¼·'],
    celebrities: {
    jp: ['æ¾ä¸‹å¥ˆç·’','æœ¨æ‘æ–‡ä¹ƒ'],
    kr: ['TWICE ãƒ¢ãƒ¢'],
    global: ['Charlize Theron','Cate Blanchett']
  }
}
};

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ±ç”¨èª¬æ˜/ææ¡ˆãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚¿ã‚¤ãƒ—å›ºæœ‰ãŒç„¡ã‘ã‚Œã°è‡ªå‹•è£œå®Œï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function describeBodyByCode(code){
  const [a,b,c,d]=code.split('');
  const p1=(a==='B')?'éª¨æ ¼ã‚„é–¢ç¯€ã®å­˜åœ¨æ„ŸãŒãƒ™ãƒ¼ã‚¹':'è‚‰æ„Ÿãƒ»ç­‹è‚‰ã®åšã¿ãŒãƒ™ãƒ¼ã‚¹';
  const p2=(b==='W')?'å…¨ä½“ã¯è»½ã‚„ã‹ã§ç¹Šç´°':'å…¨ä½“ã¯é‡åšã§å®‰å®šæ„Ÿã‚ã‚Š';
  const p3=(c==='U')?'ä¸Šé‡å¿ƒã§ä¸ŠåŠèº«ã«è¦–ç·šãŒé›†ã¾ã‚Šã‚„ã™ã„':'ä¸‹é‡å¿ƒã§ä¸‹åŠèº«ã«å®‰å®šãŒå‡ºã‚„ã™ã„';
  const p4=(d==='C')?'è¼ªéƒ­ã¯ç›´ç·šå¯„ã‚Šã§ã‚·ãƒ£ãƒ¼ãƒ—':'è¼ªéƒ­ã¯æ›²ç·šå¯„ã‚Šã§ã‚½ãƒ•ãƒˆ';
  return `ã€éª¨æ ¼å°è±¡ã¾ã¨ã‚ã€‘${p1}ã€‚${p2}ã€‚${p3}ã€‚${p4}ã€‚`;
}
function autoBrands(code, base){
  const [a,b,c,d]=code.split('');
  const core={WAVE:['SNIDEL','Lily Brown','Mila Owen','IÃ‰NA','N.O.R.C','URBAN RESEARCH ROSSO'],
              NATURAL:['JOURNAL STANDARD','IÃ‰NA','UNITED ARROWS','BEAUTY&YOUTH','BEAMS','TOMORROWLAND'],
              STRAIGHT:['Theory','Max Mara','PLST','UNIQLO U','COS','ZARA Premium']};
  const addLine=(d==='C')?['COS','Theory','AURALEE']:['SNIDEL','TOCCA','CELFORD'];
  const addDen=(b==='W')?['Deuxieme Classe','ENFÃ–LD']:['Max Mara','STUNNING LURE'];
  const addBal=(c==='U')?['Drawer','FOXEY']:['URBAN RESEARCH','Spick & Span'];
  return [...new Set([...(core[base]||[]),...addLine,...addDen,...addBal])].slice(0,7);
}
function autoStyle(code){
  const [a,b,c,d]=code.split('');
  const fabric=(b==='N')?['è–„æ‰‹ã‚¦ãƒ¼ãƒ«','ã‚·ãƒ•ã‚©ãƒ³/ã‚¸ãƒ§ãƒ¼ã‚¼ãƒƒãƒˆ','ã‚¹ãƒ ãƒ¼ã‚¹ãƒ‹ãƒƒãƒˆ']:['ãƒŸãƒƒãƒ‰ã€œåšæ‰‹ã‚¦ãƒ¼ãƒ«','ãƒãƒªã®ã‚ã‚‹ãƒ„ã‚¤ãƒ«','ã‚µãƒ†ãƒ³/ã‚¸ãƒ£ã‚«ãƒ¼ãƒ‰'];
  const neck=(d==='C')?['ã‚¯ãƒ«ãƒ¼/ãƒœãƒ¼ãƒˆ','ã‚¹ã‚¿ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼','æµ…Vã‚·ãƒ£ãƒ„']:['ãƒ©ã‚¦ãƒ³ãƒ‰/ã‚¹ã‚«ãƒ¼ãƒ•ã‚¿ã‚¤','ãƒãƒ¼ãƒˆãƒãƒƒã‚¯','Vãƒãƒƒã‚¯ï¼‹ãƒ‰ãƒ¬ãƒ¼ãƒ—'];
  const silhouette=(c==='U')?['çŸ­ã‚ãƒˆãƒƒãƒ—ã‚¹Ã—ãƒã‚¤ã‚¦ã‚¨ã‚¹ãƒˆ','Iãƒ©ã‚¤ãƒ³ãƒ¯ãƒ³ãƒ”','ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆJK']:['ãƒ­ãƒ³ã‚°ãƒˆãƒƒãƒ—ã‚¹Ã—è½ã¡æ„Ÿãƒœãƒˆãƒ ','Aãƒ©ã‚¤ãƒ³/ãƒ•ãƒ¬ã‚¢','ãƒ‰ãƒ­ãƒƒãƒ—ã‚·ãƒ§ãƒ«ãƒ€ãƒ¼'];
  const lines=(d==='C')?['ã‚»ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ¬ã‚¹','ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆã‚¹ã‚«ãƒ¼ãƒˆ','ãƒ†ãƒ¼ãƒ©ãƒ¼ãƒ‰']:['ãƒã‚¤ã‚¢ã‚¹/ãƒ‰ãƒ¬ãƒ¼ãƒ—','ãƒãƒ¼ãƒ¡ã‚¤ãƒ‰/ãƒ•ãƒ¬ã‚¢','ã‚®ãƒ£ã‚¶ãƒ¼æ§ãˆã‚'];
  return {fabric,neck,silhouette,lines};
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ UIãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const $=(s,el=document)=>el.querySelector(s);
const app=document.getElementById('app');
let state = makeInitialState();


function render(){
  app.innerHTML='';
  if(state.step===0) return renderIntro();
  if(state.step>=1 && state.step<=4) return renderAxis(AXES[state.step-1]);
  if(state.step===5) return renderResult();
}

function renderIntro(){
  const el=document.createElement('div');
  el.innerHTML=`
    <div class="result">
      <h2>4å°è±¡è»¸ã§åˆ¤å®šã™ã‚‹ã€16ã‚¿ã‚¤ãƒ—ï¼ˆFinal + Brand/Styleï¼‰</h2>
      <p class="muted">Frameï¼ˆéª¨æ ¼/è‚‰æ„Ÿï¼‰ãƒ»Surfaceï¼ˆåºƒ/ç‹­ï¼‰ãƒ»Balanceï¼ˆä¸Š/ä¸‹ï¼‰ãƒ»Lineï¼ˆç›´/æ›²ï¼‰ã‚’ã‚¹ã‚³ã‚¢åŒ–ã—ã€4æ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹ï¼šBHUCï¼‰ã‚’ç”Ÿæˆã€‚<br>ã‚¿ã‚¤ãƒ—ã”ã¨ã«å‹•ç‰©çµµæ–‡å­—ãƒ»ã‚³ãƒ³ã‚»ãƒ—ãƒˆãƒ»ä¼¼åˆã†ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«æŒ‡é‡ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>
      <div class="controls">
        <button id="start">ã¯ã˜ã‚ã‚‹</button>
        <button class="secondary" id="how">è¨­è¨ˆã®è€ƒãˆæ–¹</button>
      </div>
    </div>`;
  app.appendChild(el);
  $('#start',el).onclick=()=>{state.step=1;render();};
  $('#how',el).onclick=()=>alert('Final Edition: Natural=BWç³»ã®ã¿ï¼MWUSâ‡„MNLCå…¥æ›¿ï¼å„ã‚¿ã‚¤ãƒ—ã«å‹•ç‰©ãƒ¢ãƒãƒ¼ãƒ•ã€ãƒ–ãƒ©ãƒ³ãƒ‰ã€ã‚¹ã‚¿ã‚¤ãƒ«ãƒãƒ¼ãƒˆã‚’ä»˜ä¸ã€‚ç”»åƒã¯ images/CODE.jpg ã§ä»»æ„è¡¨ç¤ºã€‚');
}

function renderAxis(axis){
  const {key,label,posLabel,negLabel}=axis; const qs=QUESTIONS[key];
  const progress=(state.step/5)*100;
  const el=document.createElement('div');
  el.innerHTML=`
    <div class="footer" style="margin-bottom:10px">
      <div class="pill">${state.step}/4ï¼š${label}</div>
      <div class="progress" style="width:58%"><div class="bar" style="width:${progress}%"></div></div>
    </div>
    <div class="grid">
      ${qs.map((q,i)=>`
        <div class="q">
          <h4>${i+1}. ${q.t}</h4>
          <div class="scale">
            <label>ã¾ã£ãŸãå½“ã¦ã¯ã¾ã‚‰ãªã„ï¼ˆ1ï¼‰</label>
            <input type="range" min="1" max="5" step="1" value="${state.answers[key][i]}" data-i="${i}"/>
            <label>ã¨ã¦ã‚‚å½“ã¦ã¯ã¾ã‚‹ï¼ˆ5ï¼‰</label>
          </div>
          <div class="muted">è©•ä¾¡ï¼š<span id="v-${key}-${i}">${state.answers[key][i]}</span> / 5</div>
        </div>
      `).join('')}
    </div>
    <div class="footer">
      <div class="pill">${negLabel} â† ã‚¹ã‚±ãƒ¼ãƒ« â†’ ${posLabel}</div>
      <div class="controls">
        <button class="secondary" id="back">æˆ»ã‚‹</button>
        <button id="next">æ¬¡ã¸</button>
      </div>
    </div>`;
  app.appendChild(el);
  el.querySelectorAll('input[type=range]').forEach(r=>{
    r.oninput=e=>{const i=+e.target.dataset.i; const v=+e.target.value; state.answers[key][i]=v; $("#v-"+key+"-"+i,el).textContent=v;}
  });
  
  $('#next',el).onclick=()=>{ state.step=Math.min(5,state.step+1); render(); window.scrollTo({top:0,behavior:'smooth'}); };
$('#back',el).onclick=()=>{ state.step=Math.max(0,state.step-1); render(); window.scrollTo({top:0,behavior:'smooth'}); };

}

function computeAxis(axisKey){
  const arr = state.answers[axisKey].map(Number);
  const qs  = QUESTIONS[axisKey];
  const n   = arr.length;

  // pos=trueãªã‚‰ãã®ã¾ã¾ã€falseãªã‚‰6-vã§åè»¢
  const mapped = arr.map((v,i)=> qs[i].pos ? v : (6 - v));

  // åˆè¨ˆã¨å¹³å‡
  const total = mapped.reduce((a,b)=>a+b,0);
  const mean5 = total / n;
  const neutral = 3 * n;

  const ax  = AXES.find(a=>a.key===axisKey);
  const pos = total > neutral; // åˆ¤å®šåŸºæº–
  return { mean: mean5, total, pos, code: pos ? ax.codePos : ax.codeNeg };
}

// 4è»¸ã®ã‚³ãƒ¼ãƒ‰æ§‹ç¯‰
function buildCode(){
  const f=computeAxis('frame'),
        s=computeAxis('surface'),
        b=computeAxis('balance'),
        l=computeAxis('line');
  return {code:`${f.code}${s.code}${b.code}${l.code}`,scores:{frame:f,surface:s,balance:b,line:l}};
}

function renderResult(){
  const {code,scores}=buildCode();
  const meta=TYPE_META[code]||{name:'æœªå®šç¾©ã‚¿ã‚¤ãƒ—',base:'-',emoji:'',animal:'',image:'',concept:'',brandHints:[],styleNotes:[]};
    // --- Google Sheetsã«è‡ªå‹•é€ä¿¡ï¼ˆæœ€åˆã®1å›ã ã‘ï¼‰ ---
  if (!state._sentOnce) {
    state._sentOnce = true;

    const sid = localStorage.getItem('km_session')
      || (localStorage.setItem('km_session', (crypto?.randomUUID?.() ?? String(Math.random()))),
          localStorage.getItem('km_session'));

    sendToSheets({
      code,
      scores,
      userAgent: navigator.userAgent,
      sessionId: sid,
      t: Date.now()
    });
  }

  const el=document.createElement('div');

  const bodyDesc=describeBodyByCode(code);
  const brands=meta.brandHints?.length?meta.brandHints:autoBrands(code,meta.base);
  const auto=autoStyle(code); 
  const notes=(meta.styleNotes?.length?meta.styleNotes:[]);

  // ï¼…ç®—å‡º
  const pf = axisPercent('frame');
  const ps = axisPercent('surface');
  const pb = axisPercent('balance');
  const pl = axisPercent('line');

  // èŠ¸èƒ½äººãƒ–ãƒ­ãƒƒã‚¯
  let celebHTML = '';
  if (meta.celebrities) {
    const { jp = [], kr = [], global = [] } = meta.celebrities;
    const group = [
      { label: 'ğŸ‡¯ğŸ‡µ æ—¥æœ¬', list: jp },
      { label: 'ğŸ‡°ğŸ‡· éŸ“å›½', list: kr },
      { label: 'ğŸŒ æµ·å¤–', list: global },
    ];
    celebHTML = `
      <div class="card guide" style="margin-top:12px">
        <h3>ä»£è¡¨çš„ãªèŠ¸èƒ½äºº</h3>
        ${group.map(g=> g.list.length
          ? `<h4>${g.label}</h4><div class="chips">${g.list.map(x=>`<span class="chip">${x}</span>`).join('')}</div>`
          : ''
        ).join('')}
        <p class="small">â€» å„ã‚¿ã‚¤ãƒ—ã«ãŠã‘ã‚‹èŠ¸èƒ½äººåˆ†é¡ã¯å…¬çš„ãªã‚‚ã®ã§ã¯ãªãã€ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°å‚¾å‘ã«åŸºã¥ãå‚è€ƒä¾‹ã§ã™ã€‚</p>
      </div>
    `;
  }

  // ãƒ¡ãƒ¼ã‚¿ãƒ¼ãƒ–ãƒ­ãƒƒã‚¯
  const barsHTML = `
    <div class="traits">
      ${[
        {key:'Frame', ax:AXES[0], data:pf},
        {key:'Surface', ax:AXES[1], data:ps},
        {key:'Balance', ax:AXES[2], data:pb},
        {key:'Line', ax:AXES[3], data:pl},
      ].map(({key,ax,data})=>`
        <div class="trait">
          <div class="row">
            <div class="title">${key}ï¼š<span class="${data.posSide?'ok':'warn'}">${data.pct}% ${data.sideLabel.replace(/ï¼ˆ.*?ï¼‰/g,'')}</span></div>
            <div class="percent">${data.pct}%</div>
          </div>
          <div class="meter">
            <div class="fill" style="width:${data.pct}%;"></div>
            <div class="thumb" style="left:${data.pct}%;"></div>
          </div>
          <div class="ends">
            <span>${ax.negLabel}</span><span>${ax.posLabel}</span>
          </div>
        </div>
      `).join('')}
    </div>
  `;

  // çµæœãƒ†ãƒ³ãƒ—ãƒ¬
  el.innerHTML=`
    <div class="cols">
      <div class="card result">
        <h2>è¨ºæ–­çµæœï¼š<span class="ok">${code}</span> â€” <span class="em">${meta.emoji||''}</span> ${meta.name}</h2>
        <div class="tags">
          <span class="tag">åŸºç›¤ä½“å‹ï¼š${baseLabel(meta.base)}</span>
          ${meta.animal?`<span class="tag">motif Animal: ${meta.animal}</span>`:''}
        </div>
        <img class="hero" src="${meta.image||''}" alt="${code} image" onerror="this.style.display='none'"/>
        <p class="concept">${meta.concept||''}</p>

        <p class="muted">4è»¸ã®å¹³å‡ã‚¹ã‚³ã‚¢</p>
        ${barsHTML}
        ${celebHTML}
        <!-- â˜… åŒæ„ãƒã‚§ãƒƒã‚¯ï¼ˆé€ä¿¡ON/OFFã®ãƒˆã‚°ãƒ«ï¼‰ -->
<label class="consent" style="display:flex;gap:10px;align-items:center;margin:10px 0 4px;">
  <input type="checkbox" id="consentBox">
  <span class="small">åŒ¿åã§è¨ºæ–­çµæœã‚’é›†è¨ˆä¿å­˜ã™ã‚‹ã“ã¨ã«åŒæ„ã—ã¾ã™</span>
</label>


        <div class="card guide" style="margin-top:12px">
          <h3>ã©ã‚“ãªéª¨æ ¼ï¼Ÿ</h3>
          <p>${bodyDesc}</p>

          <h3>ä¼¼åˆã„ã‚„ã™ã„ãƒ–ãƒ©ãƒ³ãƒ‰</h3>
          <div class="chips">${brands.map(b=>`<span class="chip">${b}</span>`).join('')}</div>

          <h3>ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°æŒ‡é‡</h3>
          <div class="cols" style="grid-template-columns:1fr 1fr">
            <div>
              <h4>ç´ æãƒ»è³ªæ„Ÿ</h4>
              <ul>${auto.fabric.map(x=>`<li>${x}</li>`).join('')}</ul>
              <h4>ãƒãƒƒã‚¯ãƒ©ã‚¤ãƒ³</h4>
              <ul>${auto.neck.map(x=>`<li>${x}</li>`).join('')}</ul>
            </div>
            <div>
              <h4>ã‚·ãƒ«ã‚¨ãƒƒãƒˆ</h4>
              <ul>${auto.silhouette.map(x=>`<li>${x}</li>`).join('')}</ul>
              <h4>ãƒ©ã‚¤ãƒ³è¨­è¨ˆ</h4>
              <ul>${auto.lines.map(x=>`<li>${x}</li>`).join('')}</ul>
            </div>
          </div>
          ${notes.length?`<h4>ã‚¿ã‚¤ãƒ—å›ºæœ‰ãƒ¡ãƒ¢</h4><ul>${notes.map(n=>`<li>${n}</li>`).join('')}</ul>`:''}
          <p class="small">â€» ææ¡ˆã¯å„è»¸ï¼ˆéª¨æ ¼/å¯†åº¦/é‡å¿ƒ/ãƒ©ã‚¤ãƒ³ï¼‰ã®ã‚¹ã‚³ã‚¢ã¨ã‚¿ã‚¤ãƒ—å›ºæœ‰æƒ…å ±ã‹ã‚‰ç”Ÿæˆã€‚ä½“å‹ã‚„å¥½ã¿ã«åˆã‚ã›ã¦å¾®èª¿æ•´ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="controls">
          <button id="retry" class="secondary">ã‚‚ã†ä¸€åº¦</button>
          <button id="export">çµæœã‚’JSONã§ä¿å­˜</button>
        </div>
      </div>

      <div class="card">
        <h3>ã‚¿ã‚¤ãƒ—ç¾¤ã®è§£èª¬</h3>
        <ul>
          <li><b>WAVE</b>ï¼šæŸ”ãƒ»è»½ãƒ»ä¸‹é‡å¿ƒãƒ»æ›²ç·šï¼ˆğŸ©° Airy / Gentle / Dreamlikeï¼‰</li>
          <li><b>NATURAL</b>ï¼šéª¨æ„Ÿãƒ»ç›´ç·šãƒ»ä¸­åº¸ï¼ˆğŸŒ¿ Calm / Organic / Minimalï¼‰â€»BLç³»ã®ã¿</li>
          <li><b>STRAIGHT</b>ï¼šåšãƒ»ç«‹ä½“ãƒ»ä¸Šé‡å¿ƒãƒ»ç›´ç·šï¼ˆğŸ–¤ Modern / Powerful / Elegantï¼‰</li>
        </ul>
      </div>
    </div>
  `;

// === è‡ªå‹•é€ä¿¡ï¼ˆåŒæ„ON ã‹ã¤ æœªé€ä¿¡ã®ã¨ãä¸€åº¦ã ã‘ï¼‰ ===
if (!state._sentOnce) {
  const agreed = getConsent() === 'yes';
  if (agreed) {
    state._sentOnce = true;

    const sid = localStorage.getItem('km_session')
      || (localStorage.setItem('km_session', (crypto?.randomUUID?.() ?? String(Math.random()))),
          localStorage.getItem('km_session'));

    const payload = { code, scores, userAgent:navigator.userAgent, sessionId:sid, t:Date.now() };
    sendToSheets(payload);
  }
}

  // ã“ã“ã§ä¸€åº¦ã ã‘ append

  app.appendChild(el);

  // === åŒæ„ãƒã‚§ãƒƒã‚¯ã®åˆæœŸçŠ¶æ…‹ã¨ã‚¤ãƒ™ãƒ³ãƒˆ ===
const cb = document.getElementById('consentBox');
if (cb) {
  // æ—¢å­˜ã®åŒæ„çŠ¶æ…‹ã§åˆæœŸåŒ–
  cb.checked = (getConsent() === 'yes');

  cb.onchange = () => {
    setConsent(cb.checked);
    // ãƒã‚§ãƒƒã‚¯ONã«åˆ‡ã‚Šæ›¿ãˆãŸç›´å¾Œã€ã¾ã é€ã£ã¦ã„ãªã‘ã‚Œã°é€ã‚‹ï¼ˆ1å›ã ã‘ï¼‰
    if (cb.checked && !state._sentOnce) {
      state._sentOnce = true;

      const sid = localStorage.getItem('km_session')
        || (localStorage.setItem('km_session', (crypto?.randomUUID?.() ?? String(Math.random()))),
            localStorage.getItem('km_session'));

      const { code, scores } = buildCode(); // å¿µã®ãŸã‚æœ€æ–°ã‚’å–å¾—
      sendToSheets({ code, scores, userAgent:navigator.userAgent, sessionId:sid, t:Date.now() });
    }
  };
}


  // ã‚¤ãƒ™ãƒ³ãƒˆ
  $('#retry', el).onclick = () => {
  state = makeInitialState();          // ãœã‚“ã¶ãƒªã‚»ãƒƒãƒˆ
  state.step = 0;                      // ã™ãæœ€åˆã®è»¸ã‹ã‚‰å†é–‹ã—ãŸã„ãªã‚‰1ã«
  render();
  window.scrollTo({ top: 0, behavior: 'smooth' });
};


  $('#export',el).onclick=()=>{ 
  // JSONä¿å­˜
  const payload={code,meta,scores,answers:state.answers};
  const blob=new Blob([JSON.stringify(payload,null,2)],{type:'application/json'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download=`kokkaku-mbti-${code}.json`; a.click();
  URL.revokeObjectURL(url);

  // ãƒœã‚¿ãƒ³ã§ã‚‚é€ã‚‹ãŒã€ä¸€åº¦é€ã£ã¦ã„ã‚Œã°é€ã‚‰ãªã„
  if (!state._sentOnce) {
    state._sentOnce = true;
    sendToSheets({ code, scores, userAgent:navigator.userAgent, t:Date.now() });
  }
};

}


// ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‰ã«å…¥ã‚ŒãŸã„å ´åˆã¯â†“ã®è¡Œã®ç›´å‰ã« ${barsHTML} ã‚’æŒ¿å…¥

function baseLabel(b){
  return b==='WAVE'?'WAVEï¼ˆæŸ”ãƒ»è»½ãƒ»ä¸‹é‡å¿ƒï¼‰'
       : b==='STRAIGHT'?'STRAIGHTï¼ˆåšãƒ»ç«‹ä½“ãƒ»ä¸Šé‡å¿ƒï¼‰'
       : b==='NATURAL'?'NATURALï¼ˆéª¨æ„Ÿãƒ»ç›´ç·šãƒ»ãƒ©ãƒ•ï¼‰' : b;
}
render();
/* â”€â”€â”€â”€â”€ ï¼…ãƒãƒ¼ç”¨ï¼šå„è»¸ã®ã€Œå³å´å¯„ã‚Šï¼…ã€ã‚’ç®—å‡º â”€â”€â”€â”€â”€ */
function axisPercent(axisKey){
  const arr = state.answers[axisKey].map(Number);
  const qs  = QUESTIONS[axisKey];

  // 0..1 æ­£è¦åŒ–ï¼ˆå·¦å‘ãè¨­å•ã¯åè»¢ï¼‰
  const normalized = arr.map((v,i)=>{
    const s = (v-1)/4;          // 1â†’0, 5â†’1
    return qs[i].pos ? s : (1-s);
  });
  const avg = normalized.reduce((a,b)=>a+b,0)/normalized.length; // 0..1
  const pct = Math.round(avg*100); // 0..100ï¼ˆå³å´ï¼codePosæ–¹å‘ã®ï¼…ï¼‰

  // ãƒ©ãƒ™ãƒ«æ±ºå®šï¼ˆã©ã¡ã‚‰å¯„ã‚Šã‹ï¼‰
  const ax = AXES.find(a=>a.key===axisKey);
  const sideLabel = (pct>50) ? ax.posLabel : ax.negLabel;
  return { pct, sideLabel, posSide: pct>50 };
}


</script>



</body>
</html>
